# PortfolioLab-Parser

PortfolioLab-Parser 是一個用於分析和評估投資組合的工具，提供基於財務數據的回歸分析和可視化結果。該工具旨在幫助用戶快速了解投資組合的表現，並提供相關的統計指標。

---

## 安裝

請使用以下指令將此 Repository 克隆到本地環境：

```bash
git clone https://github.com/MarkovChenITRI/PortfolioLab_Parser.git
```
## 使用方法

### 1. 定義投資組合

在程式中定義投資組合的分類及其對應的股票代碼。例如：
```python
portfolio_list = {'silicon': ['NVDA','ARM', 'INTC', 'IBM', 'META', 'AMD', 'TXN', 'QCOM', 'AVGO', 'MU'],
          'robotics': ['BSX', 'TELA'],
          'fab': ['TSM', 'ASML', 'AMAT', 'INTC', 'AMKR'],
          'ai': ['XOVR', 'MSFT', 'META', 'GOOG'],
          'it/ot': ['MSFT', 'AMZN', 'GOOG'],
          'pda': ['AAPL', 'DELL', 'HPQ', 'META']
}
```

### 2. 執行分析

使用 IXIC_Parsor 類別進行分析：
```python
import asyncio
from utils import IXIC_Parsor

portfolio_list = {'silicon': ['NVDA','ARM', 'INTC', 'IBM', 'META', 'AMD', 'TXN', 'QCOM', 'AVGO', 'MU'],
          'robotics': ['BSX', 'TELA'],
          'fab': ['TSM', 'ASML', 'AMAT', 'INTC', 'AMKR'],
          'ai': ['XOVR', 'MSFT', 'META', 'GOOG'],
          'it/ot': ['MSFT', 'AMZN', 'GOOG'],
          'pda': ['AAPL', 'DELL', 'HPQ', 'META']
}

parser = IXIC_Parsor(portfolio_list = portfolio_list)
asyncio.run(parser.update_async())
df = parser.fit()
```
### 3. 顯示結果

如果您使用Google Colab來測試這段程式，可以使用IPython來顯示分析結果：
```python
from IPython.display import display_markdown
display_markdown(f"### Goodness of Fit: {parser.r2}\n" + df.to_markdown(), raw=True)
```
執行程式後，將輸出以下內容：
* Goodness of Fit：模型的擬合優度 (R²)。
* 投資組合中每支股票的財務指標，包括 Sharpe Ratio、Beta、PE Ratio、Market Cap 等。

2025/04/15範例輸出如下：
```
### Goodness of Fit: 0.8929511590632132
|      |   Sharpo |    beta |   trailingPE |   forwardPE |   shortRatio |     marketCap |   profitMargins |   priceToBook |   currentPrice |   targetHighPrice |   targetLowPrice |   recommendationMean |   Preimum    |
|:-----|---------:|--------:|-------------:|------------:|-------------:|--------------:|----------------:|--------------:|---------------:|------------------:|-----------------:|---------------------:|-------------:|
| BSX  |     1.62 |   0.731 |     75.416   |    33.7885  |         1.6  |  139431919616 |         0.11071 |      6.38513  |          94.27 |            135    |           84     |              1.5     |   1.16459    |
| IBM  |     1.11 |   0.662 |     37.1788  |    22.5316  |         3.98 |  221671735296 |         0.09598 |      8.10923  |         239.06 |            320    |          160     |              2.42857 |   0.953912   |
| AVGO |     0.62 |   1.068 |     82.5741  |    28.9076  |         1.53 |  838639812608 |         0.18473 |      3.01177  |         178.36 |            300    |          198     |              1.425   |   0.345418   |
| AAPL |     0.58 |   1.259 |     32.146   |    24.3706  |         2.11 | 3042275753984 |         0.24295 |     45.6332   |         202.52 |            300    |          165     |              2       |   0.335153   |
| NVDA |     0.45 |   1.958 |     37.6565  |    26.8714  |         0.78 | 2701323927552 |         0.55848 |     34.1592   |         110.71 |            220    |          115     |              1.37097 |   0.287394   |
| TSM  |     0.19 |   1.307 |     22.6183  |    19.2871  |         1.9  |  808271872000 |         0.40537 |      0.94236  |         155.84 |            273    |          165.663 |              1.33333 |   0.096508   |
| META |     0.13 |   1.279 |     22.2749  |    21.0071  |         1.57 | 1346589556736 |         0.37909 |      7.37399  |         531.48 |            935    |          505     |              1.48485 |   0.0659754  |
| AMZN |    -0.02 |   1.393 |     32.8736  |    29.613   |         1.53 | 1932730302464 |         0.09287 |      6.74618  |         182.12 |            306    |          200     |              1.38028 |   0.0433995  |
| XOVR |     0.08 | nan     |     32.2336  |   nan       |       nan    |               |       nan       |    nan        |         nan    |            nan    |          nan     |            nan       |   0.0251728  |
| ARM  |    -0.23 | nan     |    138.237   |    51       |         2.79 |  110733238272 |         0.21819 |     17.2512   |         105.06 |            225    |           73     |              2.15385 |  -0.00667292 |
| GOOG |     0.05 |   1.035 |     20.0833  |    18.0413  |         2.16 | 1952253083648 |         0.28604 |      6.06528  |         161.47 |            237    |          173     |              1.56716 |  -0.0992121  |
| MSFT |    -0.31 |   1     |     31.2498  |    25.9405  |         2.1  | 2882971631616 |         0.35428 |      9.52569  |         387.81 |            650    |          415     |              1.44068 |  -0.215794   |
| TXN  |    -0.27 |   0.976 |     29.0906  |    25.6769  |         2.57 |  137379422208 |         0.30682 |      8.13733  |         150.98 |            284    |          130     |              2.4     |  -0.230799   |
| ASML |    -0.63 |   1.26  |     30.7668  |    25.2011  |         1.27 |  264572485632 |         0.2679  |     14.3222   |         672.87 |           1199.59 |          750.92  |              1.76923 |  -0.334165   |
| QCOM |    -0.39 |   1.287 |     15.0151  |    11.381   |         2.24 |  153944145920 |         0.25936 |      5.72398  |         139.19 |            250    |          140     |              2.19444 |  -0.423039   |
| AMD  |    -0.83 |   1.885 |     94.5     |    18.5294  |         1.32 |  153527533568 |         0.06364 |      2.66257  |          94.5  |            225    |           90     |              1.93878 |  -0.436566   |
| HPQ  |    -0.41 |   1.109 |      8.64748 |     6.67778 |         3.21 |   22662580224 |         0.05045 |    -21.1806   |          24.04 |             40    |           25     |              2.75    |  -0.469113   |
| AMAT |    -0.63 |   1.603 |     18.8928  |    14.9154  |         2.51 |  117422096384 |         0.22953 |      6.30447  |         144.53 |            250    |          164     |              1.78947 |  -0.49195    |
| DELL |    -0.56 |   1.015 |     13.3527  |     9.06277 |         1.97 |   59449077760 |         0.04805 |    -40.0141   |          85.19 |            170    |           89     |              1.54167 |  -0.571787   |
| MU   |    -0.68 |   1.183 |     16.9904  |     5.51826 |         1.22 |   79369822208 |         0.14916 |      1.63264  |          71.02 |            200    |           60     |              1.5     |  -0.575168   |
| INTC |    -0.74 |   1.122 |    nan       |    20.9381  |         1.08 |   88563580928 |        -0.35321 |      0.885894 |          20.31 |             31    |           17.7   |              3       |  -0.591502   |
| AMKR |    -0.86 |   1.892 |     11.8741  |     8.89005 |         2.1  |    4195010816 |         0.05604 |      1.00945  |          16.98 |             36    |           16     |              2       |  -0.7232     |
| TELA |    -1.11 |   0.984 |    nan       |    -1.48529 |         1.73 |      39946612 |        -0.54605 |      1.39889  |           1.01 |              7    |            2     |              1.6     |  -0.956145   |
```
